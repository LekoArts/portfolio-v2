---
title: "Creating a Figma Plugin with Svelte"
subtitle: ""
date: 2022-05-27
lastUpdated: 2022-05-27
description: "Learn how to use Svelte, TypeScript, and Rollup to create a lean & fast Figma Plugin. You'll access the Unsplash API to fetch a random image."
type: "tutorial"
category: "JavaScript"
image: file-name-inside-og-images-folder.png
published: true
---

## Introduction

For me personally [Figma](https://www.figma.com) was certainly **the tool** that changed my webdesign workflow the most, and for the better. Coming from Photoshop it's the much better tool for the job and it also enabled me way quicker to write plugins for it. If you know HTML, CSS, and JS you can write a Figma plugin! The [Figma Developers documentation](https://www.figma.com/plugin-docs/intro/) explains the fundamentals about Figma plugins and also how you can e.g. create one with React. However, in this tutorial you'll (potentially) step out of your comfort zone and learn how to use Svelte, TypeScript, and [Rollup](https://rollupjs.org/guide/en/) to write a plugin for Figma.

The popularity of [Svelte](https://svelte.dev/) is rising and more and more people enjoy writing smaller to bigger apps with it. So it's certainly good to have it in your toolbelt and to have some familarity with it. Coming from React I most enjoyed the "simplicity" to some aspects of writing code in Svelte, as where React felt really verbose and clunky in comparison. Another thing you'll learn to appreciate is the output and speed of Svelte apps. Lastly, why should you care about Figma? Well, it's a super popular tool amongst individuals and larger teams -- and super extensible with plugins.

Here's what you'll build. You can pull a random image from [Unsplash](https://unsplash.com/) in the given size:

<Video
  src="/video/figma-plugin-usage-example.mp4"
  ariaLabel="Video showcasing the example plugin in action."
  description="Showcasing the Figma plugin in action. After selecting valid inputs for width & height an image is added to the canvas. Invalid inputs throw an error."
  maxWidth="100%"
/>

The finished project is available on GitHub at [figma-plugin-svelte-example](https://github.com/LekoArts/figma-plugin-svelte-example). You can also use this as a template for your next project.

<Alert status="info" title="Prerequisites">

If you want to follow this tutorial step-by-step you'll need to have a Figma Account ([Sign Up for an account](https://www.figma.com/signup)) and the desktop app installed ([download](https://www.figma.com/downloads/)).

</Alert>

## Conceptual Guide

Here's what you'll use and build explained on a higher level as a short summary:

1. Inside Figma initialize a new plugin to create the necessary files
1. Add dependencies like Svelte, Rollup, TypeScript, and [Figma Plugin DS Svelte](https://github.com/thomas-lowry/figma-plugin-ds-svelte) to build the app
1. Use the Figma Plugin DS Svelte UI kit to build out the UI
1. Leverage the browser `fetch` API to pull a random image from Unsplash and place it onto the current Figma frame

## Setup Guide

### Initializing a Plugin

Open the Figma desktop app and if you haven't already log into your account. Create a new design file in your drafts as you'll use this as a testground for the plugin. Once you have the design file open, go to _Menu => Plugins => Development => New Plugin..._.

First, it'll ask for a name (choose the name "SvelteTutorial") and whether you want to create a "Figma design + Figjam" or "Figma design" plugin. Choose "Figma Design". In the next step, choose the "Empty" template. The "Save As" dialogue asks you for a directory where you want to create the project. Figma will create a folder with the given name inside your provided folder. Once that's done you should see a `code.js` and `manifest.json` file inside the newly created folder. Delete the `code.js` file, it'll be autogenerated later.

The `manifest.json` will contain something like this:

```json title=manifest.json
{
  "name": "SvelteTutorial",
  "id": "1234567890123456789",
  "api": "1.0.0",
  "main": "code.js",
  "editorType": ["figma"]
}
```

You can learn more about the `manifest.json` file in the [Figma Plugin Manifest documentation](https://www.figma.com/plugin-docs/manifest/) but in a nutshell: This is the file with the plugin's unique ID (assigned during the _New Plugin..._ flow) and settings regarding the plugin. `main` points to the JavaScript code of our plugin. `ui` specifies the HTML file used in the iframe modal.

Add a new key called `ui` to `manifest.json` and change the location of `main`:

```json title=manifest.json {5-6}
{
  "name": "SvelteTutorial",
  "id": "1234567890123456789",
  "api": "1.0.0",
  "main": "dist/code.js",
  "ui": "dist/ui.html",
  "editorType": ["figma"]
}
```

Since you'll be using TypeScript to write the source files and Rollup to compile the files into a `dist` folder, the `manifest.json` now points to the (soon to be) compiled files.

### Adding Dependencies

Initialize a new `package.json` with `npm init -y` and add the following dependencies (use the "Copy" button for easier installation):

```shell
npm install @figma/plugin-typings @rollup/plugin-commonjs @rollup/plugin-html @rollup/plugin-node-resolve @rollup/plugin-typescript cssnano figma-plugin-ds-svelte postcss rollup rollup-plugin-postcss rollup-plugin-svelte rollup-plugin-svg rollup-plugin-terser svelte tslib typescript
```

Also, create a `.gitignore` will the following contents:

```text title=.gitignore
node_modules
dist
.cache
```

Since you'll use TypeScript a `tsconfig.json` for the compiler is necessary. You can use this configuration:

```json title=tsconfig.json
{
  "compilerOptions": {
    "target": "es6",
    "esModuleInterop": true,
    "moduleResolution": "node",
    "forceConsistentCasingInFileNames": true,
    "importsNotUsedAsValues": "error",
    "skipLibCheck": true,
    "typeRoots": ["./node_modules/@types", "./node_modules/@figma"]
  },
  "include": ["./src/**/*"]
}
```

Lastly, add `scripts` to your `package.json` to compile files on the fly in development mode and for production when you want to publish:

```json title=package.json
{
  "scripts": {
    "build": "rollup -c",
    "dev": "rollup -c -w",
    "clean": "rm -rf dist",
    "typecheck": "tsc --noEmit"
  }
}
```

### Compiling files

In these next steps you'll create the source files that will be compiled by Rollup and the configuration for Rollup itself.

Start by creating a directory called `src` and create three files in this directory: `code.ts`, `main.ts`, and `App.svelte`.

The `code.ts` will be responsible for creating the iframe and listening for messages. For now it only needs to contain this:

```ts title=src/code.ts
figma.showUI(__html__, { width: 320, height: 220 })
```

<!-- TODO: Explain what figma.showUI does -->

In order to load `App.svelte` the `main.ts` file sets up the app onto the `document.body`:

```ts title=src/main.ts
import "svelte"
import App from "./App.svelte"

const app = new App({
  target: document.body,
})

export default app
```

And now you can write Svelte code! Start with -- of course ðŸ˜‰ -- a "Hello World":

```svelte title=src/App.svelte
<div>Hello World</div>
```

The last missing piece to this is `rollup.config.js`. It'll define how these three source files are bundled into something that Figma can work with:

```js title=rollup.config.js withLineNumbers
import resolve from "@rollup/plugin-node-resolve"
import commonjs from "@rollup/plugin-commonjs"
import typescript from "@rollup/plugin-typescript"
import html from "@rollup/plugin-html"
import svelte from "rollup-plugin-svelte"
import { terser } from "rollup-plugin-terser"
import svg from "rollup-plugin-svg"
import postcss from "rollup-plugin-postcss"
import cssnano from "cssnano"

const production = !process.env.ROLLUP_WATCH

/**
 * @type {import('rollup').RollupOptions}
 */
const mainConfig = {
  input: `src/main.ts`,
  output: {
    format: `iife`,
    name: `ui`,
    file: `dist/bundle.js`,
  },
  plugins: [
    typescript(),
    svelte({
      compilerOptions: {
        dev: !production,
      },
    }),
    resolve({
      browser: true,
      dedupe: (importee) =>
        importee === `svelte` || importee.startsWith(`svelte/`),
    }),
    commonjs(),
    svg(),
    postcss({
      extensions: [`.css`],
      plugins: [cssnano()],
    }),
    html({
      fileName: `ui.html`,
      template({ bundle }) {
        return `
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Your Name</title>
  </head>
  <body>
    <script>${bundle[`bundle.js`].code}</script>
  </body>
</html>
        `
      },
    }),
    production && terser(),
  ],
  watch: {
    clearScreen: false,
  },
}

/**
 * @type {import('rollup').RollupOptions}
 */
const codeConfig = {
  input: `src/code.ts`,
  output: {
    file: `dist/code.js`,
    format: `cjs`,
    name: `code`,
  },
  plugins: [
    typescript(),
    commonjs(),
    resolve({
      browser: true,
    }),
    production && terser(),
  ],
}

const config = [mainConfig, codeConfig]

export default config
```

<Collapsible summary={<em>Detailed explanation of <code>rollup.config.js</code></em>}>

TODO

</Collapsible>

Now it's time you try out what you have so far in Figma. In your terminal, run:

```shell
npm run dev
```

You should see some output in the terminal that signals that Rollup successfully compiled the files you created:

```shell
$ rollup -c -w
rollup v2.67.3
bundles src/main.ts â†’ dist/bundle.js...
created dist/bundle.js in 573ms
bundles src/code.ts â†’ dist/code.js...
created dist/code.js in 357ms
```

The `manifest.json` now points to these compiled files. Go back to Figma and open a draft design file that you can use as a playground. Once you have it open, you now can run your plugin by doing a _Right click => Plugins => Development => SvelteTutorial_. You should a new window pop-up with the name of your plugin and a "Hello World" as text.

<Alert status="success" title="What you just learned">

Congrats, you successfully set up a boilerplate for creating Figma plugins with Svelte! You now know how to initialize a new plugin from Figma and how to configure the `manifest.json` file. After that you've installed Rollup to compile Svelte and TypeScript files.

</Alert>

## Svelte App

Now that you have a barebones project ready, it's time for you to create the UI and add functionality to it. As a reminder: The goal of the plugin (and thus the UI) is to fetch a random image from Unsplash in a specific size (width & height) and place it onto the current Figma canvas. For this you'll learn how to use [Figma Plugin DS Svelte](https://github.com/thomas-lowry/figma-plugin-ds-svelte) as a UI kit, how to fetch images, and how to use Figma's API to place images.

### Creating the UI

The Figma Plugin DS Svelte will serve you in two ways:

1. It has an [extensive list](https://github.com/thomas-lowry/figma-plugin-ds-svelte/blob/9372e4952f5f248c44ee760f515d5f2a42f81234/src/global.css) of CSS variables and utility classes (similar to Tailwind CSS) to help build UIs with your own set of components
1. It features a bunch of components like Buttons, Menus, Switches, etc. to build UIs quicker

In order to use Figma Plugin DS Svelte you'll need to add its `GlobalCSS` import to your `App.svelte` to have the CSS styles available.

```svelte title=App.svelte
<script lang="ts">
  import { GlobalCSS } from "figma-plugin-ds-svelte"
</script>
```

Then you have the utility classes (similar to Tailwind CSS) and CSS variables available. Create a wrapper component for the contents that will follow:

```svelte title=App.svelte
<script lang="ts">
  import { GlobalCSS } from "figma-plugin-ds-svelte"
</script>

<div class="p-xsmall wrapper flex column justify-content-between">
  <div>
    Contents
  </div>
  <div class="mt-small footer pt-xxsmall">
    Footer
  </div>
</div>

<style>
  .wrapper {
    text-align: center;
    height: 100%;
  }
  .footer {
    border-top: 1px solid var(--silver);
  }
</style>
```

This is the syntax you should be familiar with when using Svelte. When you run the plugin inside Figma again, you should see "Contents" and "Footer" aligned and formatted in the pop-up box.

<Alert status="info" title="style block in App.svelte">

In the rest of this tutorial the `<style>` block inside `App.svelte` won't change anymore. For the sake of keeping code snippets more concise the `<style>` block will be omitted from any intermediate steps. The end result will contain everything again.

</Alert>

Time to add some inputs. For this, add the `Type`, `Label`, and `Button` component to your `App.svelte`:

```svelte title=App.svelte {2,6-30}
<script lang="ts">
  import { GlobalCSS, Type, Label, Button } from "figma-plugin-ds-svelte"
</script>

<div class="p-xsmall wrapper flex column justify-content-between">
  <div>
    <Type>
      Get a Random Image from
      <a href="https://unsplash.com/">Unsplash</a>
    </Type>
    <div class="flex mt-xsmall">
      <div class="flex ml-xxsmall mr-xxsmall">
        <Label>Width:</Label>
        Input
      </div>
      <div class="flex ml-xxsmall mr-xxsmall">
        <Label>Height:</Label>
        Input
      </div>
    </div>
    <div class="mt-xxsmall flex justify-content-center">
      <Button>Add Image</Button>
    </div>
  </div>
  <div class="mt-small footer pt-xxsmall">
    <Type>
      Read the tutorial
      <a href="https://www.lekoarts.de">on lekoarts.de</a>
    </Type>
  </div>
</div>
```

The UI is nearly done! When you run the plugin again inside Figma you'll see the two inputs for width and height horizontally aligned with the blue "Add Image" button below them. Now it's time to add the proper `Input` to your UI.

At the time of writing this guide the [`Input` component](https://github.com/thomas-lowry/figma-plugin-ds-svelte/blob/9372e4952f5f248c44ee760f515d5f2a42f81234/src/components/Input/index.svelte) from `figma-plugin-ds-svelte` didn't offer the possibility to define the `type` on the `<input />` (it defaults to `type="input"`). In order to be able to built-in validations for numbers the `type` has to be `number` and thus you need to "fork" the component. Or in other words: Create your own `Input` component by copying the contents and adapting it to use `type="number"`.

Create a new file called `Input.svelte` inside `src`:

```svelte title=src/Input.svelte
<script lang="ts">
  export let id = null
  export let value = null
  export let name = null
  export let placeholder = "Placeholder"
</script>

<input type="number" {name} required min="0" {id} bind:value {placeholder} />

<style>
  input {
    font-size: var(--font-size-xsmall);
    font-weight: var(--font-weight-normal);
    letter-spacing: var(--font-letter-spacing-neg-xsmall);
    line-height: var(--line-height);
    position: relative;
    display: flex;
    overflow: visible;
    align-items: center;
    width: 100%;
    height: 30px;
    margin: 1px 0 1px 0;
    padding: var(--size-xxsmall) var(--size-xxxsmall) var(--size-xxsmall) var(--size-xxsmall);
    color: var(--black8);
    border: 1px solid transparent;
    border-radius: var(--border-radius-small);
    outline: none;
    background-color: var(--white);
  }
  input:hover,
  input:placeholder-shown:hover {
    color: var(--black8);
    border: 1px solid var(--black1);
    background-image: none;
  }
  input::selection {
    color: var(--black);
    background-color: var(--blue3);
  }
  input::placeholder {
    color: var(--black3);
    border: 1px solid transparent;
  }
  input:placeholder-shown {
    color: var(--black8);
    border: 1px solid var(--black1);
    background-image: none;
  }
  input:focus:placeholder-shown {
    border: 1px solid var(--blue);
    outline: 1px solid var(--blue);
    outline-offset: -2px;
  }
  input:active,
  input:focus {
    color: var(--black);
    border: 1px solid var(--blue);
    outline: 1px solid var(--blue);
    outline-offset: -2px;
  }
</style>
```

### Adding Funcionality

TODO

- getImage
- addImage
- code.ts `postMessage`

## Publishing

TODO

## Next Steps

TODO
